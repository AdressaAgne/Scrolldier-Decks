$(function(){function e(e,t){return Math.random()*(t-e)+e}function t(){d.totalUnits=d.units.length;for(var e=0;e<d.totalUnits;e++)0==e?$("#units").append(a(e,!1)):(d.units[e].price=d.units[0].price*Math.pow(d.unitPriceMultiplyer,e),d.units[e].basePrice=d.units[0].price*Math.pow(d.unitPriceMultiplyer,e),$("#units").append(a(e,!0)));setInterval(c,d.gameTick),r()}function a(e,t){var t=t?"hidden":"",a=d.units[e],c=a.desc?a.desc:"",r='<div class="col-4 '+t+'" id="level-'+e+'"><div class="col-12 game-unit"><h4>'+a.name+' <small style="color: #CE0000" class="value-'+e+'"></small></h4><div class="col-6"><h1 id="count-'+e+'" style="padding: 50px;">0</h1></div><div class="col-6 align-center game-unit-image-container"><img src="/img/gravelock/'+(e+1)+'.png" class="game-unit-game" alt="" /><h3><span id="ap-'+e+'">'+a.ap+'</span> - <span id="cd-'+e+'">'+a.cd+'</span> - <span id="hp-'+e+'">'+a.hp+'</span></h3></div><div class="form-element align-center"><button id="summon-'+e+'" data-level="'+e+'" class="btn">Summon '+a.shortName+' <span class="price">('+n(a.price,"","")+'g)</span></button><div class="col-12"><button id="xTimes-5-'+e+'" data-level="'+e+'" data-times="5" class="btn">x5 <span class="price">('+n(o(a.price,5),"","")+'g)</span></button><button id="xTimes-25-'+e+'" data-level="'+e+'" data-times="25" class="btn">x25 <span class="price">('+n(o(a.price,25),"","")+'g)</span></button><button id="xTimes-100-'+e+'" data-level="'+e+'" data-times="100" class="btn">x100 <span class="price">('+n(o(a.price,100),"","")+'g)</span></button></div><div class="align-center col-12" id="raw-'+e+'"></div><p id="desc-'+e+'"class="align-center col-12">'+c+'</p><p style="color: #ffeb04;" id="bonus-'+e+'" class="align-center col-12"></p></div></div></div>';return r}function c(){for(var e=0,t=0,a=d.gameTick/d.gameSpeed,c=0;c<d.totalUnits;c++)e+=d.units[c].ap/a/(d.units[c].cd/a)*d.units[c].count,t+=d.units[c].ap/d.units[c].cd*d.units[c].count;d.player.gold+=e/(d.player.idolHealth/a)*d.player.idolKillReward,d.player.goldSec=Math.round(t/d.player.idolHealth*d.player.idolKillReward);for(var c=0;c<d.totalUnits;c++){var i=d.units[c];i.count>0&&i.clockEffect&&"function"==typeof i.clockEffect&&($("#bonus-"+c).text("Bonus: "+i.clockEffect(i.count)),i.hasIdle&&(d.idle?$("#desc-"+c).find(".effect").css("color","#88b837"):$("#desc-"+c).find(".effect").css("color","#CE0000")))}d.clock++,d.clock>=d.clockReset&&(d.idle=!0,d.clock=0),r()}function r(){var e=Math.round(d.player.gold),t=d.player.goldSec;$("#gold").text(n(e,""," g")+" "+n(t,"(","g/Sec)"));for(var a=0,c=0;c<d.totalUnits;c++){var r=d.units[c];$("#count-"+c).text(n(r.count,"","x"));var l=r.ap/r.cd*r.count;a+=l,$(".value-"+c).text(n(l,""," DPS")),$("#raw-"+c).text(r.ap/r.cd+" Raw DPS"),$("#ap-"+c).text(r.ap),$("#cd-"+c).text(r.cd),$("#hp-"+c).text(r.hp),$("#summon-"+c).find(".price").text(n(Math.round(r.price),"(","g)")),$("#xTimes-5-"+c).find(".price").text(n(Math.round(o(r.price,5)),"(","g)")),$("#xTimes-25-"+c).find(".price").text(n(Math.round(o(r.price,25)),"(","g)")),$("#xTimes-100-"+c).find(".price").text(n(Math.round(o(r.price,100)),"(","g)")),i("#summon-"+c,r.price,!1),i("#xTimes-5-"+c,o(r.price,5),!0),i("#xTimes-25-"+c,o(r.price,25),!0),i("#xTimes-100-"+c,o(r.price,100),!0),r.count>0&&$("#level-"+(c+1))&&$("#level-"+(c+1)).show()}$("#total_dps").html(d.idle?n(a,""," DPS <span style='color: #88b837'>(Idle)</span>"):n(a,""," DPS"))}function i(e,t,a){d.player.gold>=t?($(e).addClass("success"),$(e).removeClass("danger"),a&&$(e).show()):($(e).removeClass("success"),$(e).addClass("danger"),a&&$(e).hide())}function n(e,t,a){for(var c=["","k","m","b","t","Qa","Qi","Sx","Sp","Oc","No","De","Un","Du"],r=c.length;r>0;r--)if(e>Math.pow(10,3*r+1))return t+Math.round(e/Math.pow(10,3*r))+c[r]+a;return t+Math.round(e)+a}function l(){if(d.debugMode){d.debugMode=!1,d.priceMultiplyer=1.15;for(var e=0;e<d.totalUnits;e++)d.units[e].price=d.units[e].basePrice}else{d.debugMode=!0,d.priceMultiplyer=0;for(var e=0;e<d.totalUnits;e++)d.units[e].price=0}}function o(e,t){var a=d.priceMultiplyer;t=parseInt(t);var c=e*Math.pow(a,t+.5-1)/Math.log(a)-e*Math.pow(a,-0.5)/Math.log(a);return c}function s(e,t,a){var c=d.units[e];if(t>1)var i=parseInt(o(c.price,t,"",""));else var i=parseInt(c.price);if(d.player.gold>=i||a){d.idle=!1,d.clock=0;for(var e=0;e<d.totalUnits;e++){var l=d.units[e];l.clock&&(l.clock=0)}c.count+=t,a||(d.player.gold-=i),t>1?c.price=c.price*Math.pow(d.priceMultiplyer,t):c.price*=d.priceMultiplyer,c.effect&&"function"==typeof c.effect&&c.effect(c.effectValue*t),$(this).find(".price").text(n(o(c.price,t),"(","g)")),r()}}var d={gameTick:100,gameSpeed:1e3,priceMultiplyer:1.15,unitPriceMultiplyer:6,totalUnits:0,debugMode:!1,idle:!1,clock:0,clockReset:100,player:{level:0,gold:3,idol:0,goldSec:0,idolHealth:10,idolKillReward:20},units:[{name:"Gravelock Raider",shortName:"Raider",elderBoost:!0,tier1:0,tier2:1e3,tier3:3e3,price:3,basePrice:3,ap:1,cd:2,hp:2,count:0,round:0},{name:"Gravelock Guard",shortName:"Guard",elderBoost:!0,tier1:1e3,tier2:3e3,tier3:9e3,price:18,basePrice:18,ap:2,cd:2,hp:3,count:0,round:0},{name:"Gravelock Outcast",shortName:"Outcast",elderBoost:!0,tier1:3e3,tier2:9e3,tier3:27e3,price:108,basePrice:18,ap:3,cd:2,hp:3,count:0,round:0},{name:"Lockling Brood",shortName:"Locklings",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:648,basePrice:18,ap:4,cd:1,hp:4,count:0,round:0},{name:"Gravelock Freak",shortName:"Freak",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:3888,basePrice:18,ap:3,cd:2,hp:6,count:0,round:0,desc:"Deals additional damage per round equal to its health.",clockEffect:function(e){var t=d.units[4],a=t.hp/t.cd,c=d.gameTick/d.gameSpeed,r=a/(d.player.idolHealth/c)*d.player.idolKillReward;return d.player.gold+=r,n(a,"","DPS")+", "+n(r,"","G/s")}},{name:"Gravelock Elder",shortName:"Elder",effectValue:1,tier1:6e3,tier2:18e3,tier3:54e3,price:23328,basePrice:18,ap:3,cd:2,hp:5,count:0,round:0,desc:"Increases attack and health of all Gravelocks by 1.",effect:function(e){for(var t=0;t<d.totalUnits;t++){var a=d.units[t];a.elderBoost&&(a.ap+=parseInt(e),a.hp+=parseInt(e))}}},{name:"Uhu Longnose",shortName:"Uhu",elderBoost:!0,effectValue:2,tier:1,tier1:6e3,tier2:18e3,tier3:54e3,price:139968,basePrice:18,ap:2,cd:2,hp:4,count:0,round:0,desc:"Increases your gold each round by the number of units you control.",clockEffect:function(e){for(var t=0,a=0;a<d.totalUnits;a++){var c=d.units[a];t+=c.count*e}return t-=d.units[6].count,d.player.gold+=t/10,n(t,"","G/s")}},{name:"Snargl",shortName:"Snargl",tier1:6e3,tier2:18e3,tier3:54e3,price:839808,basePrice:18,ap:4,cd:2,hp:5,count:0,round:0,hasIdle:!0,desc:"<span class='effect' style='color: #ffeb04;'>[Idle]</span>: Attack increases by 10",clockEffect:function(e){var t=d.units[7];return d.idle?(t.ap=14,"+"+10*t.count+" Attack"):(t.ap=4,"0 Attack")}},{name:"Snargl Omelette",shortName:"Omelette",tier:1,tier1:6e3,tier2:18e3,tier3:54e3,price:5038848,basePrice:18,ap:0,cd:15,hp:4,count:0,round:0,clock:0,clockReset:150,lastUnit:"",desc:"Spawns a random Unit every 15 sec",clockEffect:function(t){var a=d.units[8];if(a.clock++,a.clock>=a.clockReset){var c=parseInt(e(0,7));a.lastUnit=a.count+"x "+d.units[c].name,s(c,a.count,!0),a.clock=0}var r=parseInt((a.clockReset-a.clock)/10);return a.lastUnit+" ("+r+"s)"}}]};t(),$("#debug").click(function(){l()}),$("[id*=summon-]").click(function(){var e=parseInt($(this).attr("data-level"));s(e,1,!1)}),$("[id*=xTimes-]").click(function(){var e=parseInt($(this).attr("data-level")),t=parseInt($(this).attr("data-times"));s(e,t,!1)})});