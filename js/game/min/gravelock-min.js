$(function(){function e(){o.totalUnits=o.units.length;for(var e=0;e<o.totalUnits;e++)$("#units").append(0==e?t(e,!1):t(e,!0));setInterval(a,o.gameTick),i()}function t(e,t){var t=t?"hidden":"",a=o.units[e],i=a.desc?a.desc:"",s='<div class="col-4 '+t+'" id="level-'+e+'"><div class="col-12 game-unit"><h4>'+a.name+' <small class="value-'+e+'"></small></h4><p>'+i+'</p><div class="col-6"><h1 id="count-'+e+'" style="padding: 50px;">0</h1></div><div class="col-6 align-center"><img src="/img/gravelock/'+(e+1)+'.png" height="100px" alt="" /><h3><span id="ap-'+e+'">'+a.ap+'</span> - <span id="cd-'+e+'">'+a.cd+'</span> - <span id="hp-'+e+'">'+a.hp+'</span></h3></div><div class="form-element align-center"><button id="summon-'+e+'" data-level="'+e+'" class="btn">Summon '+a.shortName+' <span class="price">('+r(a.price,"","")+'g)</span></button><div class="col-12"><button id="xTimes-5-'+e+'" data-level="'+e+'" data-times="5" class="btn">x5 <span class="price">('+r(l(a.price,5),"","")+'g)</span></button><button id="xTimes-25-'+e+'" data-level="'+e+'" data-times="25" class="btn">x25 <span class="price">('+r(l(a.price,25),"","")+'g)</span></button><button id="xTimes-100-'+e+'" data-level="'+e+'" data-times="100" class="btn">x100 <span class="price">('+r(l(a.price,100),"","")+'g)</span></button></div><div class="align-center col-12" id="raw-'+e+'">Raw DPS</div></div></div></div>';return s}function a(){for(var e=0,t=0,a=o.gameTick/o.gameSpeed,r=0;r<o.totalUnits;r++)e+=o.units[r].ap/a/(o.units[r].cd/a)*o.units[r].count,t+=o.units[r].ap/o.units[r].cd*o.units[r].count;o.player.gold+=e/(o.player.idolHealth/a)*o.player.idolKillReward,o.player.goldSec=Math.round(t/o.player.idolHealth*o.player.idolKillReward),i()}function i(){var e=Math.round(o.player.gold),t=o.player.goldSec;$("#gold").text(r(e,"","g")+" "+r(t,"(","g/s)"));for(var a=0,i=0;i<o.totalUnits;i++){var s=o.units[i];$("#count-"+i).text(r(s.count,"","x"));var n=s.ap/s.cd*s.count;a+=n,$(".value-"+i).text(r(n,""," DPS")),$("#raw-"+i).text(s.ap/s.cd+" Raw DPS"),$("#ap-"+i).text(s.ap),$("#cd-"+i).text(s.cd),$("#hp-"+i).text(s.hp),$("#summon-"+i).find(".price").text(r(Math.round(s.price),"(","g)")),$("#xTimes-5-"+i).find(".price").text(r(Math.round(l(s.price,5)),"(","g)")),$("#xTimes-25-"+i).find(".price").text(r(Math.round(l(s.price,25)),"(","g)")),$("#xTimes-100-"+i).find(".price").text(r(Math.round(l(s.price,100)),"(","g)")),o.player.gold>=l(s.price,5)?$("#xTimes-5-"+i).show():$("#xTimes-5-"+i).hide(),o.player.gold>=l(s.price,25)?$("#xTimes-25-"+i).show():$("#xTimes-25-"+i).hide(),o.player.gold>=l(s.price,100)?$("#xTimes-100-"+i).show():$("#xTimes-100-"+i).hide(),o.player.gold>=s.price?($("#summon-"+i).addClass("success"),$("#summon-"+i).removeClass("danger")):($("#summon-"+i).removeClass("success"),$("#summon-"+i).addClass("danger")),o.player.gold>=l(s.price,5)?($("#xTimes-5-"+i).addClass("success"),$("#xTimes-5-"+i).removeClass("danger")):($("#xTimes-5-"+i).removeClass("success"),$("#xTimes-5-"+i).addClass("danger")),o.player.gold>=l(s.price,25)?($("#xTimes-25-"+i).addClass("success"),$("#xTimes-25-"+i).removeClass("danger")):($("#xTimes-25-"+i).removeClass("success"),$("#xTimes-25-"+i).addClass("danger")),o.player.gold>=l(s.price,100)?($("#xTimes-100-"+i).addClass("success"),$("#xTimes-100-"+i).removeClass("danger")):($("#xTimes-100-"+i).removeClass("success"),$("#xTimes-100-"+i).addClass("danger")),s.count>0&&$("#level-"+(i+1))&&$("#level-"+(i+1)).show()}$("#total_dps").text(r(a,""," DPS"))}function r(e,t,a){for(var i=["k","m","b","t","Qa","Qi","Sx","Sp","Oc","No","De","Un","Du"],r=i.length;r>0;r--)if(e>Math.pow(10,3*r+4))return t+Math.round(e/Math.pow(10,3*r+3))+i[r]+a;return t+e+a}function s(){o.priceMultiplyer=0;for(var e=0;e<o.totalUnits;e++)o.units[e].price=0}function l(e,t){var a=o.priceMultiplyer;t=parseInt(t);var i=e*Math.pow(a,t+.5-1)/Math.log(a)-e*Math.pow(a,-0.5)/Math.log(a);return i}var o={gameTick:100,gameSpeed:1e3,priceMultiplyer:1.15,totalUnits:0,player:{level:0,gold:3,idol:0,goldSec:0,idolHealth:10,idolKillReward:20},units:[{name:"Gravelock Raider",shortName:"Raider",elderBoost:!0,tier1:0,tier2:1e3,tier3:3e3,price:3,ap:1,cd:2,hp:2,count:0,round:0},{name:"Gravelock Guard",shortName:"Guard",elderBoost:!0,tier1:1e3,tier2:3e3,tier3:9e3,price:18,ap:2,cd:2,hp:3,count:0,round:0},{name:"Gravelock Outcast",shortName:"Outcast",elderBoost:!0,tier1:3e3,tier2:9e3,tier3:27e3,price:108,ap:3,cd:2,hp:3,count:0,round:0},{name:"Lockling Brood",shortName:"Locklings",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:648,ap:4,cd:1,hp:4,count:0,round:0},{name:"Gravelock Freak",shortName:"Freak",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:3888,ap:3,cd:2,hp:6,count:0,round:0},{name:"Gravelock Elder",shortName:"Elder",tier1:6e3,tier2:18e3,tier3:54e3,price:23328,ap:3,cd:2,hp:5,count:0,round:0,desc:"Gives +1/0/1 to all gravelocks",effect:function(e){for(var t=0;t<o.totalUnits;t++){var a=o.units[t];a.elderBoost&&(parseInt(a.ap)+=parseInt(e),parseInt(a.hp)+=parseInt(e))}}},{name:"Uhu Longnose",shortName:"Uhu",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:139968,ap:2,cd:2,hp:4,count:0,round:0},{name:"Snargl",shortName:"Snargl",tier1:6e3,tier2:18e3,tier3:54e3,price:839808,ap:4,cd:2,hp:5,count:0,round:0}]};e(),$("#debug").click(function(){s()}),$("[id*=summon-]").click(function(){var e=o.units[$(this).attr("data-level")];o.player.gold>=e.price&&(e.count++,o.player.gold-=e.price,e.price*=o.priceMultiplyer,e.effect&&"function"==typeof e.effect&&e.effect(1),$(this).find(".price").text(r(Math.round(e.price),"(","g)")),i())}),$("[id*=xTimes-]").click(function(){console.log(1);var e=o.units[$(this).attr("data-level")],t=parseInt($(this).attr("data-times")),a=l(e.price,t,"","");console.log(a+","+e.price),o.player.gold>=a&&(console.log(t),e.count+=t,o.player.gold-=a,e.price*=Math.pow(o.priceMultiplyer,t),console.log(3),e.effect&&"function"==typeof e.effect&&e.effect(t),$(this).find(".price").text(r(l(e.price,t),"(","g)")),i())})});