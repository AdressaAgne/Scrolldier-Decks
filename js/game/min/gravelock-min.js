$(function(){function e(e,t){return Math.random()*(t-e)+e}function t(){g.totalUnits=g.units.length,g.totalSpells=g.spells.length;for(var e=0;e<g.totalUnits;e++)0==e?$("#units").append(r(e,!1)):(g.units[e].price=g.units[0].price*Math.pow(g.unitPriceMultiplyer,e),g.units[e].tier2=g.units[0].price*Math.pow(g.unitPriceMultiplyer,e)*3,g.units[e].tier3=g.units[0].price*Math.pow(g.unitPriceMultiplyer,e)*9,g.units[e].basePrice=g.units[0].price*Math.pow(g.unitPriceMultiplyer,e),$("#units").append(r(e,!0)));for(var e=0;e<g.totalSpells;e++)$("#spells").append(c(e,!1));setInterval(a,g.gameTick),o()}function r(e,t){var t=t?"hidden":"",r=g.units[e],c=r.desc?r.desc:"",a='<div class="col-4 '+t+'" id="level-'+e+'"><div class="col-12 game-unit"><h4>'+r.name+' <small style="color: #CE0000" class="value-'+e+'"></small></h4><div class="col-6"><h1 id="count-'+e+'" style="padding: 50px;">0</h1></div><div class="col-6 align-center game-unit-image-container"><img src="/img/gravelock/'+(e+1)+'.png" class="game-unit-game" alt="" /><h3><span id="ap-'+e+'">'+r.ap+'</span> - <span id="cd-'+e+'">'+r.cd+'</span> - <span id="hp-'+e+'">'+r.hp+'</span></h3></div><div class="form-element align-center"><button id="summon-'+e+'" data-level="'+e+'" class="btn">Summon '+r.shortName+' <span class="price">('+i(r.price,"","")+'g)</span></button><div class="col-12"><button id="xTimes-5-'+e+'" data-level="'+e+'" data-times="5" class="btn">x5 <span class="price">('+i(d(r.price,5),"","")+'g)</span></button><button id="xTimes-25-'+e+'" data-level="'+e+'" data-times="25" class="btn">x25 <span class="price">('+i(d(r.price,25),"","")+'g)</span></button><button id="xTimes-100-'+e+'" data-level="'+e+'" data-times="100" class="btn">x100 <span class="price">('+i(d(r.price,100),"","")+'g)</span></button></div><div class="align-center col-12" id="raw-'+e+'"></div><p id="desc-'+e+'"class="align-center col-12">'+c+'</p><p style="color: #ffeb04;" id="bonus-'+e+'" class="align-center col-12"></p></div></div></div>';return a}function c(e,t){var t=t?"hidden":"",r=g.spells[e],c=r.desc?r.desc:"",a='<div class="col-4 '+t+'" id="spell-level-'+e+'"><div class="col-12 game-spell"><h4>'+r.name+'</h4><div class="col-12 align-center"><img src="/img/gravelock/s'+(e+1)+'.png" alt="" /></div><div class="form-element align-center"><button id="cast-'+e+'" data-level="'+e+'" class="btn">Cast '+r.shortName+' <span class="price">('+i(r.price,""," ")+g.player.resouceName[r.resource]+')</span></button><p id="spell-desc-'+e+'"class="align-center col-12">'+c+'</p><p style="color: #ffeb04;" id="spell-bonus-'+e+'" class="align-center col-12"></p></div></div></div>';return a}function a(){for(var e=0,t=0,r=g.gameTick/g.gameSpeed,c=0;c<g.totalUnits;c++)e+=g.units[c].ap/r/(g.units[c].cd/r)*g.units[c].count,t+=g.units[c].ap/g.units[c].cd*g.units[c].count;g.player.gold+=e/(g.player.idolHealth/r)*g.player.idolKillReward,g.player.goldSec=Math.round(t/g.player.idolHealth*g.player.idolKillReward);for(var c=0;c<g.totalUnits;c++){var a=g.units[c];a.count>0&&a.clockEffect&&"function"==typeof a.clockEffect&&($("#bonus-"+c).text("Bonus: "+a.clockEffect(a.count)),a.hasIdle&&(g.idle?$("#desc-"+c).find(".effect").css("color","#88b837"):$("#desc-"+c).find(".effect").css("color","#CE0000")))}g.clock++;for(var c=0;c<g.totalSpells;c++){var l=g.spells[c];l.cooldown&&!l.cooldown<=0&&l.cooldown--,l.clockEffect&&"function"==typeof l.clockEffect&&$("#spell-bonus-"+c).text("Cooldown: "+l.clockEffect())}g.clock>=g.clockReset&&(g.idle=!0,g.clock=0),o()}function l(e){e?($("#game-gold").removeClass("col-6"),$("#game-gold").addClass("col-4"),$("#game-dps").removeClass("col-6"),$("#game-dps").addClass("col-4"),$("#game-res").show()):($("#game-gold").removeClass("col-4"),$("#game-gold").addClass("col-6"),$("#game-dps").removeClass("col-4"),$("#game-dps").addClass("col-6"),$("#game-res").hide())}function o(){var e=Math.round(g.player.gold),t=g.player.goldSec;$("#gold").text(i(e,""," g")+" "+i(t,"(","g/Sec)"));for(var r=0,c=0;c<g.totalSpells;c++){var a=g.spells[c];s(g.player.res.energy,"#cast-"+c,a.price,!1)}g.player.res.energy>0&&l(!0),$("#res-energy").text(i(g.player.res.energy,"",""));for(var c=0;c<g.totalUnits;c++){var o=g.units[c];$("#count-"+c).text(i(o.count,"","x"));var n=o.ap/o.cd*o.count;r+=n,$(".value-"+c).text(i(n,""," DPS")),$("#raw-"+c).text(o.ap/o.cd+" Raw DPS"),$("#ap-"+c).text(o.ap),$("#cd-"+c).text(o.cd),$("#hp-"+c).text(o.hp),$("#summon-"+c).find(".price").text(i(Math.round(o.price),"(","g)")),$("#xTimes-5-"+c).find(".price").text(i(Math.round(d(o.price,5)),"(","g)")),$("#xTimes-25-"+c).find(".price").text(i(Math.round(d(o.price,25)),"(","g)")),$("#xTimes-100-"+c).find(".price").text(i(Math.round(d(o.price,100)),"(","g)")),s(g.player.gold,"#summon-"+c,o.price,!1),s(g.player.gold,"#xTimes-5-"+c,d(o.price,5),!0),s(g.player.gold,"#xTimes-25-"+c,d(o.price,25),!0),s(g.player.gold,"#xTimes-100-"+c,d(o.price,100),!0),o.count>0&&$("#level-"+(c+1))&&$("#level-"+(c+1)).show()}$("#total_dps").html(g.idle?i(r,""," DPS <span style='color: #88b837'>(Idle)</span>"):i(r,""," DPS"))}function s(e,t,r,c){e>=r?($(t).addClass("success"),$(t).removeClass("danger"),c&&$(t).show()):($(t).removeClass("success"),$(t).addClass("danger"),c&&$(t).hide())}function i(e,t,r){for(var c=["","k","m","b","t","Qa","Qi","Sx","Sp","Oc","No","De","Un","Du"],a=c.length;a>0;a--)if(e>Math.pow(10,3*a+1))return t+Math.round(e/Math.pow(10,3*a))+c[a]+r;return t+Math.round(e)+r}function n(){if(g.debugMode){g.debugMode=!1,g.priceMultiplyer=1.15;for(var e=0;e<g.totalUnits;e++)g.units[e].price=g.units[e].basePrice}else{g.debugMode=!0,g.priceMultiplyer=0;for(var e=0;e<g.totalUnits;e++)g.units[e].price=0}}function d(e,t){var r=g.priceMultiplyer;t=parseInt(t);var c=e*Math.pow(r,t+.5-1)/Math.log(r)-e*Math.pow(r,-0.5)/Math.log(r);return c}function p(e,t,r){var c=g.units[e];if(t>1)var a=parseInt(d(c.price,t,"",""));else var a=parseInt(c.price);if(g.player.gold>=a||r){for(var e=0;e<g.totalUnits;e++){var l=g.units[e];l.clock&&(l.clock=0)}c.count+=t,r||(g.player.gold-=a,g.idle=!1,g.clock=0),t>1?c.price=c.price*Math.pow(g.priceMultiplyer,t):c.price*=g.priceMultiplyer,c.effect&&"function"==typeof c.effect&&c.effect(c.effectValue*t),$(this).find(".price").text(i(d(c.price,t),"(","g)")),o()}}function u(e,t){var r=g.spells[e];(g.player.res.energy>=r.price||t)&&(t||(g.idle=!1,g.clock=0,r.cooldown?r.cooldown<=0&&(g.player.res.energy-=r.price):g.player.res.energy-=r.price),r.effect&&"function"==typeof r.effect&&r.effect(),o())}var f={growth:0,energy:1,decay:2,order:3,wild:4},g=function(){var t={gameTick:100,gameSpeed:1e3,priceMultiplyer:1.15,unitPriceMultiplyer:6,totalUnits:0,totalSpells:0,debugMode:!1,idle:!1,clock:0,clockReset:100,player:{level:0,gold:3,idol:0,goldSec:0,idolHealth:10,idolKillReward:20,res:{growth:0,energy:0,decay:0,order:0,wild:0},resouceName:{0:"Growth",1:"Energy",3:"Decay",4:"Order",5:"Wild"}},units:[{name:"Gravelock Raider",shortName:"Raider",elderBoost:!0,tier1:0,tier2:1e3,tier3:3e3,price:3,basePrice:3,ap:1,cd:2,hp:2,count:0,round:0},{name:"Gravelock Guard",shortName:"Guard",elderBoost:!0,tier1:1e3,tier2:3e3,tier3:9e3,price:18,basePrice:18,ap:2,cd:2,hp:3,count:0,round:0},{name:"Gravelock Outcast",shortName:"Outcast",elderBoost:!0,tier1:3e3,tier2:9e3,tier3:27e3,price:108,basePrice:18,ap:3,cd:2,hp:3,count:0,round:0},{name:"Lockling Brood",shortName:"Locklings",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:648,basePrice:18,ap:4,cd:1,hp:4,count:0,round:0},{name:"Gravelock Freak",shortName:"Freak",elderBoost:!0,tier1:6e3,tier2:18e3,tier3:54e3,price:3888,basePrice:18,ap:3,cd:2,hp:6,count:0,round:0,desc:"Deals additional damage per round equal to its health.",clockEffect:function(e){var r=t.units[4],c=r.hp/r.cd,a=t.gameTick/t.gameSpeed,l=c/(t.player.idolHealth/a)*t.player.idolKillReward;return t.player.gold+=l,i(c,"","DPS")+", "+i(l,"","G/s")}},{name:"Gravelock Elder",shortName:"Elder",effectValue:1,tier1:6e3,tier2:18e3,tier3:54e3,price:23328,basePrice:18,ap:3,cd:2,hp:5,count:0,round:0,desc:"Increases attack and health of all Gravelocks by 1.",effect:function(e){for(var r=0;r<t.totalUnits;r++){var c=t.units[r];c.elderBoost&&(c.ap+=parseInt(e),c.hp+=parseInt(e))}}},{name:"Uhu Longnose",shortName:"Uhu",elderBoost:!0,effectValue:2,tier:1,tier1:6e3,tier2:18e3,tier3:54e3,price:139968,basePrice:18,ap:2,cd:2,hp:4,count:0,round:0,desc:"Increases your gold each round by the number of units you control.",clockEffect:function(e){for(var r=0,c=0;c<t.totalUnits;c++){var a=t.units[c];r+=a.count*e}return r-=t.units[6].count,t.player.gold+=r/10,i(r,"","G/s")}},{name:"Snargl",shortName:"Snargl",tier1:6e3,tier2:18e3,tier3:54e3,price:839808,basePrice:18,ap:4,cd:2,hp:5,count:0,round:0,hasIdle:!0,desc:"<span class='effect' style='color: #ffeb04;'>[Idle]</span>: Attack increases by 10",clockEffect:function(e){var r=t.units[7];return t.idle?(r.ap=14,"+"+10*r.count+" Attack"):(r.ap=4,"0 Attack")}},{name:"Snargl Omelette",shortName:"Omelette",tier:1,tier1:6e3,tier2:18e3,tier3:54e3,price:5038848,basePrice:18,ap:0,cd:15,hp:4,count:0,round:0,clock:0,clockReset:150,lastUnit:"",desc:"Spawns a random Unit of lower level every 15 sec",clockEffect:function(r){var c=t.units[8];if(c.clock++,c.clock>=c.clockReset){var a=parseInt(e(0,7));c.lastUnit=c.count+"x "+t.units[a].name,p(a,c.count,!0),c.clock=0}var l=parseInt((c.clockReset-c.clock)/10)+1;return c.lastUnit+" ("+l+"s)"}},{name:"Desert Memorial",shortName:"Memorial",tier:1,tier1:0,tier2:0,tier3:0,price:0,basePrice:0,ap:0,cd:3,hp:4,count:0,round:0,clock:0,clockReset:100,lastUnit:"",desc:"Increase Energy by 1, every 10 sec",clockEffect:function(e){var r=t.units[9];r.clock++,r.clock>=r.clockReset&&(t.player.res.energy+=r.count,r.clock=0);var c=parseInt((r.clockReset-r.clock)/10)+1;return"+"+r.count+" Energy ("+c+"s)"}},{name:"Sand Pack Memorial",shortName:"Memorial",tier:1,tier1:0,tier2:0,tier3:0,price:0,basePrice:0,ap:0,cd:3,hp:4,count:0,round:0,clock:0,clockReset:50,lastUnit:"",desc:"Increase Energy by 5, every 5 sec",clockEffect:function(e){var r=t.units[10];r.clock++,r.clock>=r.clockReset&&(t.player.res.energy+=5*r.count,r.clock=0);var c=parseInt((r.clockReset-r.clock)/10)+1;return"+"+5*r.count+" Energy ("+c+"s)"}}],spells:[{name:"Gravelock Burrows",shortName:"Burrows",tier:1,tier2:0,tier3:0,price:30,resource:f.energy,basePrice:0,desc:"All Gravelocks get +3 Attack",effect:function(){for(var e=t.spells[0],r=0;r<t.totalUnits;r++){var c=t.units[r];c.elderBoost&&(c.ap+=3)}}},{name:"Power Trip",shortName:"Power Trip",tier:1,tier2:0,tier3:0,price:10,resource:f.energy,basePrice:0,cooldown:600,cooldownReset:600,desc:"<span style='color: #ffeb04;'>[Cooldown]</span> Increase Energy by 20",effect:function(){var e=t.spells[1];e.cooldown<=0&&(t.player.res.energy+=20,e.cooldown=e.cooldownReset)},clockEffect:function(){var e=t.spells[1];return e.cooldown<=0?"Ready":parseInt(e.cooldown/10)+1+"sec"}},{name:"Fodder Pit",shortName:"Fodder Pit",tier:1,tier2:0,tier3:0,price:1e3,resource:f.energy,basePrice:0,desc:"Double Gravelocks Attack",effect:function(){for(var e=t.spells[2],r=0;r<t.totalUnits;r++){var c=t.units[r];c.elderBoost&&(c.ap*=2)}}}]};return t}();t(),$("#debug").click(function(){n()}),$("[id*=cast-]").click(function(){var e=parseInt($(this).attr("data-level"));u(e,!1)}),$("[id*=summon-]").click(function(){var e=parseInt($(this).attr("data-level"));p(e,1,!1)}),$("[id*=xTimes-]").click(function(){var e=parseInt($(this).attr("data-level")),t=parseInt($(this).attr("data-times"));p(e,t,!1)})});